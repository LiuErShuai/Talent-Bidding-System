# 仓库协作规范

## 通用规则要求
1. 任何时候都需要阅读并遵守本节所有要求，并且在每次对话开头输出一遍。
2. 在所有流程、任务与对话过程中，必须使用 **`memory` MCP** 记录交互节点与关键决策，确保完整可追溯。
3. 所有回答均需使用简体中文。
4. 如有需要可查阅线上资料以辅助开发决策。
5. 非经明确要求禁止编写测试文件与说明文件；若确实需要测试文件，须放入新建的 `test/` 目录且仅允许保留一个长期测试文件，其余临时测试文件在验证通过后必须删除。
6. 当需要删除本地文件（或运行会执行删除操作的脚本）时，必须先说明“我想要删除[文件名]，这些文件原本用于[用途]，现在由于[原因]已经不需要了”或“我要运行[文件名]，这将删除[所有删除的文件名]，这些文件原本用于[用途]，现在由于[原因]已经不需要了”，并获得许可后才能执行。
7. 所有代码中的注释需使用中文进行讲解。
8. 每次工作流完成后，都要查看并更新 `[000]功能模块文档.md`，及时同步功能模块信息。
9. 对于每个完整任务（无论大小）需严格遵循 RIPER-5 阶段性工作流开发规范，分阶段进行内容总结汇报；若仅为普通问答可直接回复。
10. 遵照时间戳原则，将最终确认的详细计划（具体到每一步的详细规划和操作而不止是总结） (todolist) 保存为独立文件至 `/project_document/` 目录中。文件名必须包含唯一标识和简要信息，格式为 `[编号]简要任务描述.md` (例如: `[001]用户登录功能开发.md`)。 需要注意的是，编号为000-099的文档为核心文档，例如api文档、数据库设计文档、项目架构文档等；编号为100-199的文档为阶段性文档，主要包括项目中各个阶段模块的实施方案、技术方案、实现报告之类的内容；编号为200-299的文档为测试修复完善阶段文档，主要为各个模块的功能测试内容或者是bug修复方案、模块完善升级方案、修复报告之类的内容；编号300-399为技术专题文档，包括对某些技术使用的说明教学等内容。对于开发文档内容，在开头你需要标注背景与目标方便翻阅，还要写上目录，如果是开发文档，你还需要将todolist写进去。
12. 每个完整任务结束后，如项目使用 Git 管理，需要创建提交记录以便追踪。

## 项目结构与模块组织
- 根目录包含 `index.html`、`vite.config.js`、`package.json` 等构建工具相关文件，构建产物位于 `dist/`。
- 源码位于 `src/`：`views/` 存放页面，`components/` 存放复用组件，`router/` 管理路由，`store/` 管理 Pinia 仓库，`api/` 存请求封装，`assets/` 存静态资源，`src/style.css` 为全局样式，入口文件为 `src/main.js`，根组件为 `App.vue`。
- `public/` 下的资源将按原样对外提供；项目文档统一存放在 `project_document/`。

## 构建、测试与开发命令
- 安装依赖：`npm install`。
- 启动带 HMR 的开发服务器：`npm run dev`。
- 进行生产构建：`npm run build`（产出至 `dist/`）。
- 本地预览生产构建：`npm run preview`。

## 代码风格与命名规范
- 技术栈为 Vue 3 + Vite + ES Modules，优先使用 `<script setup>` 单文件组件。
- 缩进统一为 2 个空格，组件保持小而专注，复杂逻辑需以中文注释说明。
- 组件与页面文件名使用大驼峰（如 `UserCard.vue`、`ProjectHall.vue`），Pinia store 使用小驼峰命名，路由 path 使用 kebab-case。
- `src/` 内建议使用相对路径导入；与组件高度耦合的资源可就近存放。
- UI 组件库使用 Element Plus，图标来自 `@element-plus/icons-vue` 并在 `src/main.js` 中全局注册。

## 测试规范
- 当前尚未配置自动化测试。若新增测试框架，请为新增功能编写针对性测试；若暂未引入测试框架，在合并请求中列出完整的手工验证步骤。
- 未来若新增测试文件，命名规范为 `*.spec.js`，可与源码同目录或放至 `tests/` 目录。

## 提交与合并请求规范
- Commit 尽量小而聚焦，使用祈使句现在时描述（例如 `Add project hall layout`、`Fix login redirect`）。
- PR 描述需包含范围、关键改动、用户影响并关联相关任务/问题；UI 改动需附截图或 GIF，同时列出手动验证步骤（常用 `npm run dev`、`npm run build`）。

## 安全与配置提示
- 禁止提交任何敏感信息；使用环境变量和 `.env` 文件，并借助 `.gitignore` 避免入库。
- 合并前请核对 `src/api/` 中的所有网络请求配置（基地址、超时、错误处理等），确保与后台约定一致。

## RIPER-5 阶段性工作流
> 说明：当前环境仅配置了有限的 MCP 工具（如 `memory` 等），若文中提到的能力无法直接调用，请使用等效方式（如本地文档、IDE 搜索、网络检索、手动记录）实现同等目标。

### 第一阶段：R（Research - 研究）
- **目标：** 精准理解用户真实需求。
- **推荐工具：** 可用的外部文档检索方式（如网络搜索、既有资料库）、`memory` 或其他记录介质。
- **流程：**
  1. 遵守时间戳原则，检索权威资料澄清需求。
  2. 以产品经理视角明确核心问题与用户价值。
  3. 产出用户需求定义与关键验收标准，必要时记录引用来源并通过 `memory`（或等效记录方式）保存。
  4. 交互：提交研究结果，等待确认。

### 第二阶段：I（Investigate - 调查）
- **目标：** 分析内部实现与约束，提出多套方案。
- **推荐工具：** IDE/编辑器的代码检索与分析、内部知识库或文档、`memory`。
- **流程：**
  1. 阅读代码了解现状与限制。
  2. 查阅内部知识库或过往决策，必要时通过 `memory` 回忆经验。
  3. 结合架构师与开发负责人的视角做技术评估。
  4. 产出至少两种解决方案，列出优缺点、风险、工作量，并记录。
  5. 交互：提交方案选项，等待选择。

### 第三阶段：P（Plan - 计划）
- **目标：** 将选定方案转化为可执行计划并归档。
- **推荐工具：** 任意可用的任务管理方式（如本地待办、电子表格）、`filesystem`、`memory`。
- **流程：**
  1. 基于已选方案制定详细 todolist。
  2. 以项目经理视角评估资源与时间。
  3. 如有任务管理工具则录入，否则在本地文档维护。
  4. 遵照时间戳原则，将最终计划保存至 `/project_document/`，文件名格式 `[编号]任务描述.md`，编号区间说明同“通用规则要求”。
  5. 产出：已保存的计划文件，并在 `memory` 中记录。
  6. 交互：汇报计划及保存结果，等待批准。

### 第四阶段：E（Execute - 执行）
- **目标：** 按计划完成实现并实时更新进度。
- **推荐工具：** `filesystem`、`memory` 或其他可用记录方式。
- **流程：**
  1. 严格依照 `/project_document/` 中计划执行。
  2. 每完成一步立即更新计划文件并记录时间戳，同时同步到 `memory`。
  3. 产出：符合计划的代码实现，必要时通过 `filesystem` 保存。
  4. 交互：展示阶段成果并报告进度。

### 第五阶段：R（Review - 审查）
- **目标：** 确保质量、合规性与知识沉淀。
- **推荐工具：** IDE/编辑器审阅、静态分析脚本、`filesystem`、`memory`。
- **流程：**
  1. 进行静态分析与逻辑审查。
  2. 结合开发负责人、架构师、文档管理员视角检视质量与规范。
  3. 按时间戳原则将审查记录、最终决策归档至 `/project_document/`。
  4. 将可复用经验写入 `memory`。
  5. 产出：审查报告、更新后的文档以及沉淀的知识。
  6. 交互：提交审查结果并请求最终确认。

## 基于角色的专注点
> 说明：五种角色（PM、PDM、AR、LD、DW）并非独立执行，而是在 RIPER-5 各阶段提供不同思考视角，需在实际操作中自行代入相应角色完成分析与决策。

- **PM（项目经理）：** 关注规划、进度、风险与资源，确保文档与任务同步更新。
- **PDM（产品经理）：** 聚焦需求分析、用户价值、产品设计与 MVP。
- **AR（架构师）：** 负责系统设计、技术选型、架构一致性及长期规划。
- **LD（开发负责人）：** 负责代码实现、质量保障、工程细节与可维护性。
- **DW（文档管理员）：** 负责记录管理、知识沉淀、规范审核与记忆维护。
