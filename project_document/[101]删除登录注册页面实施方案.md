<!--
时间戳：2025-12-18 12:37:44
文档编号：101（阶段性文档）
-->

# [101]删除登录注册页面实施方案

## 背景与目标
当前项目的登录/注册已通过首页弹窗（`AuthDialog`）完成，不再需要独立的登录页与注册页。为了减少冗余页面、避免用户通过路由进入旧页面造成体验与逻辑分叉，需要删除登录/注册页面，并确保所有跳转与路由权限控制仍然稳定可用。

**目标：**
1. 删除登录页与注册页源码文件（以及无用目录）。
2. 保留 `/login`、`/register` 作为“认证入口”路由（不再展示页面），统一触发弹窗并回到正常页面。
3. 启用全局路由守卫：需要登录时弹窗提示并阻止跳转。
4. 根路径 `/` 默认进入 `/home`。
5. 更新核心功能模块文档 `[000]功能模块文档.md` 同步变更。

## 目录
1. 需求范围与验收标准
2. 现状调查与影响面
3. 实施方案与取舍
4. 详细 todolist（时间戳）
5. 决策记录（等效 memory 记录）
6. 变更记录

## 1. 需求范围与验收标准
**范围：**
- 删除 `src/views/auth/Login/`、`src/views/auth/Register/` 页面实现。
- 保留 `/login`、`/register` 路径用于兼容旧跳转，但不进入页面。

**验收标准：**
- 访问 `/login` 或 `/register` 不会出现旧页面；会触发登录/注册弹窗，并自动回到 `/home` 或指定 `redirect`。
- 根路径 `/` 自动进入 `/home`。
- 当访问 `meta.requiresAuth: true` 的页面且未登录时，会弹出登录弹窗且不发生页面跳转。
- `npm run build` 通过（无缺失文件/路由解析错误）。

## 2. 现状调查与影响面（摘要）
- 当前存在页面文件：
  - `src/views/auth/Login/index.vue`
  - `src/views/auth/Register/index.vue`
- 路由模块 `src/router/modules/auth.js` 引用了上述页面文件。
- `src/router/index.js` 中路由守卫 `setupGuards(router)` 之前处于注释状态。
- `src/router/modules/common.js` 里 `/` 默认重定向到 `/login`。
- 代码中存在若干 `router.push('/login')` 的历史跳转点（应保持兼容）。

## 3. 实施方案与取舍
**方案 A：完全删除 /login /register 路由**
- 优点：路由更干净。
- 缺点：历史代码 `router.push('/login')` 会进入 404；需要全量改造所有跳转点，风险更高、改动面更大。

**方案 B：保留 /login /register 作为“认证入口”，不再展示页面（推荐）**
- 优点：兼容旧跳转点；删除旧页面后不影响现有调用；统一走弹窗体验。
- 缺点：路由里仍保留两个入口路径，但其行为明确且轻量。

**选择：方案 B。**

## 4. 详细 todolist（时间戳）
> 注：每完成一步将补充完成时间，并在“变更记录”同步。

1.（2025-12-18 12:37:44）检索登录/注册页面文件、路由与引用点，确认影响范围。
   - ✅ 完成时间：2025-12-18 12:38:57
2.（2025-12-18 12:37:44）新增认证入口占位页 `src/views/auth/AuthEntry/index.vue`：进入后触发 `open-auth-dialog` 事件并回到 `/home` 或 `redirect`。
   - ✅ 完成时间：2025-12-18 12:38:57
3.（2025-12-18 12:37:44）更新 `src/router/modules/auth.js`：`/login`、`/register` 指向认证入口占位页。
   - ✅ 完成时间：2025-12-18 12:38:57
4.（2025-12-18 12:37:44）启用 `src/router/index.js` 的 `setupGuards(router)` 全局守卫。
   - ✅ 完成时间：2025-12-18 12:38:57
5.（2025-12-18 12:37:44）更新 `src/router/modules/common.js`：`/` 重定向改为 `/home`。
   - ✅ 完成时间：2025-12-18 12:38:57
6.（待确认）列出待删除文件清单并获取删除许可。
   - ✅ 完成时间：2025-12-18 12:43:14
7.（待执行）删除旧页面文件与无用目录。
   - ✅ 完成时间：2025-12-18 12:43:14
8.（待执行）运行 `npm run build` 校验构建通过。
   - ✅ 完成时间：2025-12-18 12:45:28
9.（待执行）更新 `[000]功能模块文档.md` 同步模块变化。
   - ✅ 完成时间：2025-12-18 12:46:19
10.（待执行）创建 Git 提交记录（小而聚焦）。

## 5. 决策记录（等效 memory 记录）
- 2025-12-18 12:37:44：决定保留 `/login`、`/register` 路由作为“认证入口”，以兼容历史 `router.push('/login')` 的跳转点，登录注册仍统一使用弹窗完成。
- 2025-12-18 12:37:44：决定启用全局路由守卫，并调整 `main.js` 的插件注册顺序（先 Pinia 后 Router），避免守卫中使用 store 时出现未激活 Pinia 的问题。

## 6. 变更记录
- 2025-12-18 12:37:44：计划文档创建。
- 2025-12-18 12:38:57：已完成步骤 1-5（路由改造、认证入口占位页、启用守卫、根路径重定向、main.js 注册顺序调整）。
- 2025-12-18 12:43:14：已删除登录/注册页面文件与路由模块；守卫改为“回退/首页”而非 `next(false)`，避免未捕获导航中断错误。
- 2025-12-18 12:45:28：`npm run build` 校验通过（为避免污染版本库，已在本地执行后 `git restore dist` 撤销构建产物变更）。
