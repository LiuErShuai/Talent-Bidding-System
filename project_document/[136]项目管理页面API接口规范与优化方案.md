# 项目管理页面API接口规范与优化方案

## 一、数据加载策略优化

### 1.1 优化目标

- ✅ 减少初始加载数据量（从 ~200KB 降至 ~50KB）
- ✅ 保证当前里程碑操作流畅（无需等待）
- ✅ 按需加载历史/未来里程碑详情
- ✅ 避免重复请求（智能缓存）

### 1.2 混合分级加载策略

```
初始进入页面
    ↓
请求基础数据（包含当前里程碑完整数据）
    ↓
渲染页面（当前里程碑默认展开，其他折叠）
    ↓
用户点击其他里程碑"展开详情"
    ↓
检查缓存 → 有缓存：直接展开
         → 无缓存：请求详情 → 缓存 → 展开
```

---

## 二、API接口设计

### 2.1 初始数据接口

**接口地址**：`GET /api/v1/projects/:projectId/manage/overview`

**说明**：返回项目基础信息 + 所有里程碑的基础信息 + 当前里程碑的完整详情

**请求示例**：
```http
GET /api/v1/projects/1/manage/overview
Authorization: Bearer {token}
```

**响应数据结构**：

```javascript
{
  "code": 200,
  "message": "success",
  "data": {
    // 1. 项目基础信息
    "project": {
      "id": 1,
      "title": "AI智能客服系统开发",
      "code": "PRJ-2025-001",
      "status": "executing",           // 项目状态
      "statusText": "执行中",
      "currentStage": 3,                // 当前阶段（0-8）
      "budget": 50000,
      "progress": 35,
      "startDate": "2025-10-01",
      "endDate": "2026-03-31",
      "publisher": {
        "id": 101,
        "name": "XX科技有限公司",
        "logo": "https://..."
      },
      "contractor": {
        "teamId": 201,
        "teamName": "创新开发小队",
        "leader": "张三",
        "members": [
          {
            "id": 1001,
            "name": "张三",
            "avatar": "https://...",
            "role": "队长",
            "skills": ["Vue", "Node.js"]
          }
        ]
      }
    },

    // 2. 所有里程碑的基础信息（列表视图数据）
    "milestones": [
      {
        "id": "milestone-recruitment",
        "code": "RECRUITMENT",
        "title": "揭榜征集",
        "description": "学生团队提交揭榜申请，企业审核并确定承接方",
        "status": "completed",          // completed | in-progress | pending | delayed
        "statusText": "已完成",
        "plannedDate": "2025-10-15",
        "actualDate": "2025-10-14",
        "delayDays": 0,

        // 进度信息（用于快捷面板统计）
        "progressDetail": {
          "percentage": 100,
          "completedDeliverables": 2,
          "totalDeliverables": 2,
          "status": "success",
          "note": "已完成全部交付物"
        },

        // 关键标识
        "isCurrent": false,             // 是否是当前里程碑
        "hasDetailLoaded": false        // 详情是否已加载（前端维护）
      },

      // 当前里程碑（包含完整详情数据）
      {
        "id": "milestone-proposal",
        "code": "PROPOSAL",
        "title": "方案提交",
        "description": "提交详细的技术方案和项目计划",
        "status": "in-progress",
        "statusText": "进行中",
        "plannedDate": "2025-11-20",
        "actualDate": null,
        "delayDays": 0,
        "progressDetail": {
          "percentage": 50,
          "completedDeliverables": 1,
          "totalDeliverables": 2,
          "status": "warning",
          "note": "已完成 1/2 项交付物"
        },
        "isCurrent": true,
        "hasDetailLoaded": true,

        // ========== 以下是详情数据（仅当前里程碑包含） ==========

        // 交付物要求（企业定义）
        "deliverables": [
          {
            "id": 1,
            "name": "揭榜申请书",
            "type": "document",
            "format": ["PDF", "Word"],
            "requirement": "包含团队介绍、技能匹配分析、项目理解等",
            "isRequired": true,
            "maxSize": 10485760,          // 单位：字节（10MB）
            "exampleUrl": "https://..."   // 示例文件（可选）
          },
          {
            "id": 2,
            "name": "技术方案文档",
            "type": "document",
            "format": ["PDF", "Word"],
            "requirement": "不少于10页，需包含系统架构设计、技术选型、开发计划、风险评估等",
            "isRequired": true,
            "maxSize": 10485760
          }
        ],

        // 提交记录（承接方提交的交付物）
        "submissions": [
          {
            "id": 1,
            "version": 1,
            "deliverableId": 2,
            "deliverableName": "技术方案文档",
            "fileName": "技术方案-AI智能客服系统.pdf",
            "fileUrl": "https://...",
            "fileSize": 2621440,          // 单位：字节
            "uploadTime": "2025-11-15 10:30:00",
            "uploader": {
              "id": 1001,
              "name": "张三",
              "avatar": "https://..."
            },
            "versionNote": "初版技术方案",
            "status": "rejected",         // pending | approved | rejected
            "statusText": "被驳回",

            // 审核结果（仅当 status 为 approved 或 rejected 时存在）
            "reviewResult": {
              "reviewer": {
                "id": 101,
                "name": "XX科技",
                "type": "enterprise"      // enterprise | teacher | expert
              },
              "reviewTime": "2025-11-16 14:20:00",
              "action": "rejected",       // approved | rejected
              "comment": "方案整体思路清晰，但缺少风险评估部分，建议补充",
              "rating": 3,                // 1-5星评分
              "suggestions": [            // 改进建议（可选）
                "补充项目风险评估章节",
                "完善技术选型的对比分析"
              ]
            }
          },
          {
            "id": 2,
            "version": 2,
            "deliverableId": 2,
            "deliverableName": "技术方案文档",
            "fileName": "技术方案-AI智能客服系统-v2.pdf",
            "fileUrl": "https://...",
            "fileSize": 3145728,
            "uploadTime": "2025-11-18 14:30:00",
            "uploader": {
              "id": 1001,
              "name": "张三",
              "avatar": "https://..."
            },
            "versionNote": "补充了风险评估和技术选型对比",
            "status": "pending",
            "statusText": "待审核"
          }
        ]
      },

      // 未来里程碑（仅基础信息）
      {
        "id": "milestone-execution",
        "code": "EXECUTION",
        "title": "项目执行",
        "description": "按照方案进行开发，定期提交进度报告",
        "status": "pending",
        "statusText": "待开始",
        "plannedDate": "2025-12-20",
        "actualDate": null,
        "delayDays": 0,
        "progressDetail": {
          "percentage": 0,
          "completedDeliverables": 0,
          "totalDeliverables": 3,
          "status": "info",
          "note": "尚未开始"
        },
        "isCurrent": false,
        "hasDetailLoaded": false
      }
    ],

    // 3. 项目统计数据（用于快捷面板）
    "statistics": {
      "totalMilestones": 5,
      "completedMilestones": 1,
      "inProgressMilestones": 1,
      "pendingMilestones": 3,
      "totalDeliverables": 12,
      "completedDeliverables": 2,
      "pendingSubmissions": 1,        // 待审核的提交数
      "rejectedSubmissions": 1        // 被驳回的提交数
    },

    // 4. 待办提醒数据（用于快捷面板）
    "alerts": [
      {
        "id": "alert-1",
        "type": "warning",              // success | warning | danger | info
        "title": "方案提交 - 需要修改重提",
        "description": "技术方案文档 v1 被驳回，请根据反馈修改后重新提交",
        "relatedMilestoneId": "milestone-proposal",
        "relatedSubmissionId": 1,
        "createdAt": "2025-11-16 14:20:00",
        "isRead": false
      },
      {
        "id": "alert-2",
        "type": "warning",
        "title": "方案提交 - 即将截止",
        "description": "距离截止日期还有 2 天",
        "relatedMilestoneId": "milestone-proposal",
        "createdAt": "2025-11-18 09:00:00",
        "isRead": false
      }
    ],

    // 5. 审核历史时间线（用于页面底部折叠区域）
    "timelineEvents": [
      {
        "id": 1,
        "type": "submission",           // submission | review | milestone | system
        "title": "提交了技术方案文档 v2",
        "description": "补充了风险评估和技术选型对比",
        "actor": {
          "id": 1001,
          "name": "张三",
          "avatar": "https://...",
          "role": "承接方"
        },
        "timestamp": "2025-11-18 14:30:00",
        "relatedMilestoneId": "milestone-proposal",
        "relatedSubmissionId": 2
      },
      {
        "id": 2,
        "type": "review",
        "title": "驳回了技术方案文档 v1",
        "description": "方案整体思路清晰，但缺少风险评估部分",
        "actor": {
          "id": 101,
          "name": "XX科技",
          "role": "发榜方"
        },
        "timestamp": "2025-11-16 14:20:00",
        "relatedMilestoneId": "milestone-proposal",
        "relatedSubmissionId": 1
      }
    ]
  }
}
```

---

### 2.2 里程碑详情接口（懒加载）

**接口地址**：`GET /api/v1/projects/:projectId/milestones/:milestoneId/detail`

**说明**：获取指定里程碑的完整详情数据（交付物要求 + 提交记录）

**请求示例**：
```http
GET /api/v1/projects/1/milestones/milestone-recruitment/detail
Authorization: Bearer {token}
```

**响应数据结构**：

```javascript
{
  "code": 200,
  "message": "success",
  "data": {
    "milestoneId": "milestone-recruitment",

    // 交付物要求
    "deliverables": [
      {
        "id": 1,
        "name": "揭榜申请书",
        "type": "document",
        "format": ["PDF", "Word"],
        "requirement": "包含团队介绍、技能匹配分析、项目理解等",
        "isRequired": true,
        "maxSize": 10485760
      }
    ],

    // 提交记录
    "submissions": [
      {
        "id": 1,
        "version": 1,
        "deliverableId": 1,
        "deliverableName": "揭榜申请书",
        "fileName": "揭榜申请书-创新开发小队.pdf",
        "fileUrl": "https://...",
        "fileSize": 1048576,
        "uploadTime": "2025-10-12 16:00:00",
        "uploader": {
          "id": 1001,
          "name": "张三",
          "avatar": "https://..."
        },
        "versionNote": "初次提交",
        "status": "approved",
        "statusText": "已通过",
        "reviewResult": {
          "reviewer": {
            "id": 101,
            "name": "XX科技",
            "type": "enterprise"
          },
          "reviewTime": "2025-10-13 10:00:00",
          "action": "approved",
          "comment": "团队技能匹配度高，申请书内容完整",
          "rating": 5
        }
      }
    ]
  }
}
```

---

### 2.3 上传交付物接口

**接口地址**：`POST /api/v1/projects/:projectId/milestones/:milestoneId/submissions`

**说明**：上传新的交付物版本

**请求示例**：
```http
POST /api/v1/projects/1/milestones/milestone-proposal/submissions
Authorization: Bearer {token}
Content-Type: multipart/form-data

{
  "deliverableId": 2,           // 交付物ID
  "file": [File Object],        // 文件对象
  "versionNote": "补充了风险评估和技术选型对比"
}
```

**响应数据结构**：

```javascript
{
  "code": 200,
  "message": "上传成功，等待审核",
  "data": {
    "submission": {
      "id": 3,
      "version": 3,               // 后端自动递增
      "deliverableId": 2,
      "deliverableName": "技术方案文档",
      "fileName": "技术方案-AI智能客服系统-v3.pdf",
      "fileUrl": "https://...",
      "fileSize": 3670016,
      "uploadTime": "2025-11-19 10:00:00",
      "uploader": {
        "id": 1001,
        "name": "张三",
        "avatar": "https://..."
      },
      "versionNote": "补充了风险评估和技术选型对比",
      "status": "pending",
      "statusText": "待审核"
    }
  }
}
```

---

### 2.4 下载交付物接口

**接口地址**：`GET /api/v1/submissions/:submissionId/download`

**说明**：下载指定提交记录的文件

**请求示例**：
```http
GET /api/v1/submissions/1/download
Authorization: Bearer {token}
```

**响应**：文件流（Content-Type: application/octet-stream）

---

## 三、前端实现改造方案

### 3.1 组件改造清单

#### 1. `Manage/index.vue` 主页面

**改造点**：
- ✅ 初始加载调用 `GET /api/v1/projects/:projectId/manage/overview`
- ✅ 维护 `loadedMilestoneIds` Set 记录已加载详情的里程碑
- ✅ 监听 MilestoneCardContractor 的 `expand` 事件
- ✅ 展开时检查 `hasDetailLoaded`，若为 false 则请求详情

**关键代码**：

```vue
<script setup>
import { ref, onMounted } from 'vue'
import { getProjectManageOverview, getMilestoneDetail } from '@/api/project'

const project = ref(null)
const milestones = ref([])
const statistics = ref({})
const alerts = ref([])
const timelineEvents = ref([])
const loadedMilestoneIds = ref(new Set())

// 初始加载
async function loadInitialData() {
  try {
    const res = await getProjectManageOverview(projectId)
    project.value = res.data.project
    milestones.value = res.data.milestones
    statistics.value = res.data.statistics
    alerts.value = res.data.alerts
    timelineEvents.value = res.data.timelineEvents

    // 标记当前里程碑已加载
    const currentMilestone = milestones.value.find(m => m.isCurrent)
    if (currentMilestone) {
      loadedMilestoneIds.value.add(currentMilestone.id)
    }
  } catch (error) {
    ElMessage.error('加载数据失败')
  }
}

// 处理里程碑展开事件（懒加载）
async function handleMilestoneExpand(milestoneId) {
  const milestone = milestones.value.find(m => m.id === milestoneId)

  // 如果已加载过，直接返回
  if (loadedMilestoneIds.value.has(milestoneId)) {
    return
  }

  // 显示加载状态
  milestone.isLoadingDetail = true

  try {
    const res = await getMilestoneDetail(projectId, milestoneId)

    // 合并详情数据
    milestone.deliverables = res.data.deliverables
    milestone.submissions = res.data.submissions
    milestone.hasDetailLoaded = true

    // 标记已加载
    loadedMilestoneIds.value.add(milestoneId)
  } catch (error) {
    ElMessage.error('加载里程碑详情失败')
  } finally {
    milestone.isLoadingDetail = false
  }
}

onMounted(() => {
  loadInitialData()
})
</script>

<template>
  <div class="project-manage-root">
    <!-- ... -->

    <milestone-timeline
      :milestones="milestones"
      @expand="handleMilestoneExpand"
      @upload="handleUpload"
    />
  </div>
</template>
```

---

#### 2. `MilestoneCardContractor.vue` 卡片组件

**改造点**：
- ✅ 添加 `isLoadingDetail` 属性支持
- ✅ 展开时触发 `expand` 事件（传递 milestoneId）
- ✅ 详情区域显示骨架屏（加载中状态）

**关键代码**：

```vue
<script setup>
const props = defineProps({
  milestone: {
    type: Object,
    required: true
  },
  defaultExpanded: {
    type: Boolean,
    default: false
  }
})

const emit = defineEmits(['expand', 'upload', 'viewSubmission'])

const expanded = ref(props.defaultExpanded)

function toggleExpand() {
  if (!expanded.value) {
    // 展开前触发事件（用于懒加载）
    emit('expand', props.milestone.id)
  }
  expanded.value = !expanded.value
}
</script>

<template>
  <div class="milestone-card-contractor" :class="cardClass">
    <!-- 头部 -->
    <div class="card-header">
      <el-button text @click="toggleExpand">
        {{ expanded ? '折叠详情' : '展开详情' }}
      </el-button>
    </div>

    <!-- 可折叠内容 -->
    <el-collapse-transition>
      <div v-show="expanded" class="card-content">
        <!-- 加载中状态 -->
        <div v-if="milestone.isLoadingDetail" class="loading-skeleton">
          <el-skeleton :rows="5" animated />
        </div>

        <!-- 详情内容 -->
        <div v-else-if="milestone.hasDetailLoaded">
          <!-- 交付物要求 -->
          <div class="section deliverables-requirements">
            <!-- ... -->
          </div>

          <!-- 提交记录 -->
          <div class="section submissions">
            <!-- ... -->
          </div>
        </div>

        <!-- 未加载状态 -->
        <div v-else class="empty-detail">
          <el-empty description="点击展开查看详情" />
        </div>
      </div>
    </el-collapse-transition>
  </div>
</template>
```

---

#### 3. `MilestoneTimeline.vue` 时间线组件

**改造点**：
- ✅ 传递 `expand` 事件到父组件

**关键代码**：

```vue
<script setup>
const emit = defineEmits(['expand', 'upload', 'viewSubmission'])

function handleExpand(milestoneId) {
  emit('expand', milestoneId)
}
</script>

<template>
  <div class="milestone-timeline">
    <div v-for="milestone in milestones" :key="milestone.id">
      <milestone-card-contractor
        :milestone="milestone"
        :default-expanded="milestone.isCurrent"
        @expand="handleExpand"
        @upload="handleUpload"
      />
    </div>
  </div>
</template>
```

---

### 3.2 API封装

**新建文件**：`src/api/projectManage.js`

```javascript
import request from './request'

/**
 * 获取项目管理总览数据
 * @param {number} projectId - 项目ID
 * @returns {Promise}
 */
export function getProjectManageOverview(projectId) {
  return request({
    url: `/projects/${projectId}/manage/overview`,
    method: 'get'
  })
}

/**
 * 获取里程碑详情
 * @param {number} projectId - 项目ID
 * @param {string} milestoneId - 里程碑ID
 * @returns {Promise}
 */
export function getMilestoneDetail(projectId, milestoneId) {
  return request({
    url: `/projects/${projectId}/milestones/${milestoneId}/detail`,
    method: 'get'
  })
}

/**
 * 上传交付物
 * @param {number} projectId - 项目ID
 * @param {string} milestoneId - 里程碑ID
 * @param {Object} data - 表单数据 { deliverableId, file, versionNote }
 * @returns {Promise}
 */
export function uploadDeliverable(projectId, milestoneId, data) {
  const formData = new FormData()
  formData.append('deliverableId', data.deliverableId)
  formData.append('file', data.file)
  formData.append('versionNote', data.versionNote)

  return request({
    url: `/projects/${projectId}/milestones/${milestoneId}/submissions`,
    method: 'post',
    data: formData,
    headers: {
      'Content-Type': 'multipart/form-data'
    },
    timeout: 60000  // 文件上传超时时间设为60秒
  })
}

/**
 * 下载交付物
 * @param {number} submissionId - 提交记录ID
 * @returns {Promise}
 */
export function downloadSubmission(submissionId) {
  return request({
    url: `/submissions/${submissionId}/download`,
    method: 'get',
    responseType: 'blob'
  })
}
```

---

### 3.3 Mock数据兼容适配

**改造**：`src/mock/projectManage.js`

为了兼容新的数据结构，需要调整Mock数据格式：

```javascript
export const mockProjectManageData = {
  project: {
    id: 1,
    title: 'AI智能客服系统开发',
    code: 'PRJ-2025-001',
    status: 'executing',
    statusText: '执行中',
    currentStage: 3,
    // ... 其他字段
  },

  milestones: [
    {
      id: 'milestone-recruitment',
      code: 'RECRUITMENT',
      title: '揭榜征集',
      description: '学生团队提交揭榜申请，企业审核并确定承接方',
      status: 'completed',
      statusText: '已完成',
      plannedDate: '2025-10-15',
      actualDate: '2025-10-14',
      delayDays: 0,
      progressDetail: {
        percentage: 100,
        completedDeliverables: 2,
        totalDeliverables: 2,
        status: 'success',
        note: '已完成全部交付物'
      },
      isCurrent: false,
      hasDetailLoaded: false  // 关键：初始未加载
      // 不包含 deliverables 和 submissions
    },

    {
      id: 'milestone-proposal',
      // ... 基础信息
      isCurrent: true,
      hasDetailLoaded: true,   // 关键：当前里程碑已加载

      // 包含完整详情
      deliverables: [ /* ... */ ],
      submissions: [ /* ... */ ]
    }
  ],

  statistics: { /* ... */ },
  alerts: [ /* ... */ ],
  timelineEvents: [ /* ... */ ]
}

// 模拟懒加载详情接口
export function mockGetMilestoneDetail(milestoneId) {
  // 模拟网络延迟
  return new Promise((resolve) => {
    setTimeout(() => {
      const detailData = {
        'milestone-recruitment': {
          milestoneId: 'milestone-recruitment',
          deliverables: [
            {
              id: 1,
              name: '揭榜申请书',
              type: 'document',
              format: ['PDF', 'Word'],
              requirement: '包含团队介绍、技能匹配分析、项目理解等',
              isRequired: true,
              maxSize: 10485760
            }
          ],
          submissions: [
            {
              id: 1,
              version: 1,
              deliverableId: 1,
              deliverableName: '揭榜申请书',
              fileName: '揭榜申请书-创新开发小队.pdf',
              fileUrl: 'https://example.com/files/...',
              fileSize: 1048576,
              uploadTime: '2025-10-12 16:00:00',
              uploader: {
                id: 1001,
                name: '张三',
                avatar: 'https://example.com/avatar.jpg'
              },
              versionNote: '初次提交',
              status: 'approved',
              statusText: '已通过',
              reviewResult: {
                reviewer: {
                  id: 101,
                  name: 'XX科技',
                  type: 'enterprise'
                },
                reviewTime: '2025-10-13 10:00:00',
                action: 'approved',
                comment: '团队技能匹配度高，申请书内容完整',
                rating: 5
              }
            }
          ]
        },
        // 其他里程碑的详情数据...
      }

      resolve({
        code: 200,
        message: 'success',
        data: detailData[milestoneId] || { deliverables: [], submissions: [] }
      })
    }, 500)  // 模拟500ms网络延迟
  })
}
```

---

## 四、性能对比

### 4.1 数据量对比

假设项目有 **5个里程碑**，每个里程碑平均 **2个交付物**，每个交付物平均 **3个版本提交**：

| 方案 | 初始加载数据量 | 点击展开响应 |
|------|--------------|------------|
| **一次性加载** | ~200KB（全部数据） | 即时展开（0ms） |
| **混合加载** | ~50KB（基础+当前） | 首次500ms，后续0ms |
| **全弹窗加载** | ~20KB（仅基础） | 每次500ms |

### 4.2 用户体验对比

| 操作场景 | 一次性加载 | 混合加载 | 全弹窗加载 |
|---------|----------|---------|-----------|
| 首次进入页面 | ⚠️ 2s加载 | ✅ 0.5s加载 | ✅ 0.3s加载 |
| 查看当前里程碑 | ✅ 即时展开 | ✅ 即时展开 | ⚠️ 等待0.5s |
| 查看历史里程碑 | ✅ 即时展开 | ⚠️ 首次0.5s | ⚠️ 每次0.5s |
| 重复查看历史 | ✅ 即时展开 | ✅ 即时展开 | ⚠️ 每次0.5s |

**结论**：混合加载方案在性能和体验之间取得最佳平衡。

---

## 五、实施步骤

### 阶段1：API接口开发（后端）

1. 实现 `GET /projects/:id/manage/overview` 接口
2. 实现 `GET /projects/:id/milestones/:id/detail` 接口
3. 实现 `POST /projects/:id/milestones/:id/submissions` 接口
4. 实现 `GET /submissions/:id/download` 接口

### 阶段2：前端改造（前端）

1. 创建 `src/api/projectManage.js` API封装
2. 改造 `Manage/index.vue` 主页面
3. 改造 `MilestoneCardContractor.vue` 组件
4. 改造 `MilestoneTimeline.vue` 组件
5. 更新 Mock 数据结构

### 阶段3：联调测试

1. 前后端接口联调
2. 测试懒加载逻辑
3. 测试缓存机制
4. 性能测试（网络慢速模拟）

---

## 六、注意事项

### 6.1 缓存策略

- ✅ 已加载的里程碑详情缓存在前端
- ✅ 刷新页面后重新加载
- ✅ 提交新版本后自动更新对应里程碑数据
- ⚠️ 如果需要实时性，可考虑 WebSocket 推送更新

### 6.2 错误处理

- 初始加载失败：显示错误页面，提供重试按钮
- 详情加载失败：显示错误提示，允许重新展开
- 上传失败：保留表单数据，允许重试

### 6.3 网络优化

- 启用 HTTP/2 多路复用
- 启用 Gzip 压缩（减少 ~70% 数据量）
- 文件上传采用分片上传（大文件支持）
- 实施 CDN 加速文件下载

---

## 七、后续优化方向

1. **预加载策略**：用户查看当前里程碑时，后台预加载前后相邻的里程碑详情
2. **Service Worker缓存**：离线状态下也能查看已加载的数据
3. **虚拟滚动**：如果里程碑数量超过20个，采用虚拟滚动优化渲染
4. **增量更新**：WebSocket 推送审核结果，无需手动刷新

---

## 八、总结

**推荐采用混合分级加载策略**：

✅ **优点**：
- 减少初始加载时间 60%（200KB → 50KB）
- 保证核心操作流畅（当前里程碑即时展开）
- 智能缓存避免重复请求
- 代码改动量适中

⚠️ **缺点**：
- 首次展开历史里程碑需等待 ~500ms
- 需要后端支持两个接口
- 前端需要维护加载状态

**总体评价**：最适合当前项目需求的方案，推荐实施。
