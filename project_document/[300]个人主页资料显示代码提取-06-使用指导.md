# 个人主页资料显示代码提取 - 使用指导

## 快速开始

### 1. 安装依赖

```bash
npm install vue@^3.0.0
npm install element-plus@^2.0.0
npm install @element-plus/icons-vue
npm install vue-router@^4.0.0
```

### 2. 引入Element Plus

在 `main.js` 中配置：

```javascript
import { createApp } from 'vue'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'
import * as ElementPlusIconsVue from '@element-plus/icons-vue'
import App from './App.vue'

const app = createApp(App)

// 引入Element Plus
app.use(ElementPlus)

// 注册所有图标
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
  app.component(key, component)
}

app.mount('#app')
```

### 3. 引入CSS变量系统

创建 `src/styles/variables.css` 文件，将文档05中的CSS变量定义复制进去，然后在 `main.js` 中引入：

```javascript
import './styles/variables.css'
```

### 4. 创建API配置文件

创建 `src/api/index.js`：

```javascript
import axios from 'axios'

// 创建axios实例
const authApi = axios.create({
  baseURL: 'http://your-api-domain.com/api/auth',
  timeout: 10000
})

const analysisApi = axios.create({
  baseURL: 'http://your-api-domain.com/api/analysis',
  timeout: 10000
})

// 请求拦截器（添加token）
authApi.interceptors.request.use(config => {
  const token = localStorage.getItem('access_token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

analysisApi.interceptors.request.use(config => {
  const token = localStorage.getItem('access_token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

export { authApi, analysisApi }
```

创建 `src/api/utils.js`：

```javascript
// 工具函数
export const requestUtils = {
  buildQueryString: (params) => {
    return Object.keys(params)
      .filter(key => params[key] !== undefined && params[key] !== null)
      .map(key => `${encodeURIComponent(key)}=${encodeURIComponent(params[key])}`)
      .join('&')
  }
}

export const tokenUtils = {
  setAccessToken: (token) => {
    localStorage.setItem('access_token', token)
  },
  getAccessToken: () => {
    return localStorage.getItem('access_token')
  },
  setRefreshToken: (token) => {
    localStorage.setItem('refresh_token', token)
  },
  getRefreshToken: () => {
    return localStorage.getItem('refresh_token')
  },
  setUserInfo: (userInfo) => {
    localStorage.setItem('user_info', JSON.stringify(userInfo))
  },
  getUserInfo: () => {
    const userInfo = localStorage.getItem('user_info')
    return userInfo ? JSON.parse(userInfo) : null
  },
  clearAuth: () => {
    localStorage.removeItem('access_token')
    localStorage.removeItem('refresh_token')
    localStorage.removeItem('user_info')
  }
}

export const errorUtils = {
  extractErrorMessage: (error) => {
    if (error.response?.data?.detail) {
      return error.response.data.detail
    }
    if (error.response?.data?.message) {
      return error.response.data.message
    }
    if (error.message) {
      return error.message
    }
    return '未知错误'
  }
}
```

## 组件集成步骤

### 步骤1: 复制组件文件

将以下组件文件复制到你的项目中：

1. `src/components/ProfileCard.vue` - 从文档02复制
2. `src/components/UserHeader.vue` - 从文档03复制
3. `src/components/SettingsForm.vue` - 从文档03复制
4. `src/components/SimpleProfileDisplay.vue` - 从文档03复制

### 步骤2: 复制API和状态管理文件

1. `src/api/user.js` - 从文档04复制
2. `src/composables/useAuth.js` - 从文档04复制（需要根据你的项目调整）

### 步骤3: 创建页面使用组件

#### 示例1: 个人资料页面

创建 `src/views/Profile.vue`：

```vue
<template>
  <div class="profile-page">
    <h1>个人资料</h1>
    
    <!-- 使用ProfileCard组件 -->
    <ProfileCard 
      v-if="resumeData"
      :resume-data="resumeData"
      :has-resume="!!resumeData"
    />
    
    <!-- 或使用简化版 -->
    <SimpleProfileDisplay />
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import ProfileCard from '@/components/ProfileCard.vue'
import SimpleProfileDisplay from '@/components/SimpleProfileDisplay.vue'
import { userAPI } from '@/api/user'
import { useAuthStore } from '@/composables/useAuth'

const authStore = useAuthStore()
const resumeData = ref(null)

onMounted(async () => {
  const userId = authStore.getUserId()
  if (userId) {
    try {
      const response = await userAPI.getUserProfile(userId)
      resumeData.value = response.data
    } catch (error) {
      console.error('获取用户资料失败:', error)
    }
  }
})
</script>
```

#### 示例2: 设置页面

创建 `src/views/Settings.vue`：

```vue
<template>
  <div class="settings-page">
    <h1>设置</h1>
    <SettingsForm />
  </div>
</template>

<script setup>
import SettingsForm from '@/components/SettingsForm.vue'
</script>
```

#### 示例3: 在头部使用UserHeader

在 `AppHeader.vue` 或布局组件中：

```vue
<template>
  <header class="app-header">
    <div class="header-container">
      <div class="header-left">
        <!-- 你的logo和导航 -->
      </div>
      <div class="header-right">
        <UserHeader />
      </div>
    </div>
  </header>
</template>

<script setup>
import UserHeader from '@/components/UserHeader.vue'
</script>
```

## 数据适配

### 适配你的API响应格式

如果你的API返回的数据格式不同，需要适配：

```javascript
// 在组件中适配数据格式
const adaptResumeData = (apiData) => {
  return {
    personal_info: {
      name: apiData.name || apiData.user_name,
      email: apiData.email,
      phone: apiData.phone || apiData.mobile,
      // ... 其他字段映射
    },
    technical_skills: apiData.skills || [],
    // ... 其他字段映射
  }
}
```

### 自定义数据模型

如果数据结构完全不同，可以创建适配器：

```javascript
// src/utils/dataAdapter.js
export const adaptUserProfile = (rawData) => {
  // 根据你的数据结构进行转换
  return {
    personal_info: {
      name: rawData.fullName,
      email: rawData.emailAddress,
      // ...
    }
  }
}
```

## 样式定制

### 修改主题色彩

在CSS变量文件中修改：

```css
:root {
  --color-primary: #your-color;  /* 修改主色调 */
  --color-success: #your-color;   /* 修改成功色 */
  /* ... 其他颜色 */
}
```

### 自定义组件样式

如果需要修改组件样式，可以在组件中添加额外的样式：

```vue
<style scoped>
/* 覆盖默认样式 */
.profile-card {
  border-radius: 12px; /* 自定义圆角 */
}
</style>
```

## 常见问题

### Q1: 图标不显示怎么办？

**A**: 确保已引入图标库：
- FontAwesome: 在HTML中引入CDN链接
- Element Plus Icons: 在main.js中注册图标

### Q2: 样式不生效？

**A**: 检查以下几点：
1. CSS变量是否已引入
2. Element Plus样式是否已引入
3. 组件中的scoped样式是否正确

### Q3: API请求失败？

**A**: 检查：
1. API baseURL是否正确
2. token是否正确设置
3. 请求拦截器是否正确配置

### Q4: 如何修改组件显示字段？

**A**: 在组件模板中修改对应的字段名，例如：

```vue
<!-- 修改前 -->
<el-descriptions-item label="姓名">
  {{ resumeData.personal_info?.name }}
</el-descriptions-item>

<!-- 修改后 -->
<el-descriptions-item label="昵称">
  {{ resumeData.personal_info?.nickname }}
</el-descriptions-item>
```

## 最佳实践

### 1. 数据加载状态处理

```vue
<template>
  <div v-if="loading">加载中...</div>
  <ProfileCard v-else :resume-data="resumeData" />
</template>

<script setup>
const loading = ref(true)
// ... 加载数据后设置 loading = false
</script>
```

### 2. 错误处理

```vue
<script setup>
const error = ref(null)

const loadProfile = async () => {
  try {
    const data = await userAPI.getUserProfile(userId)
    resumeData.value = data
  } catch (err) {
    error.value = err.message
    ElMessage.error('加载失败: ' + err.message)
  }
}
</script>
```

### 3. 响应式设计

组件已经包含响应式样式，但可以根据需要调整：

```css
@media (max-width: 768px) {
  .profile-section {
    /* 移动端样式调整 */
  }
}
```

## 完整示例项目结构

```
your-project/
├── src/
│   ├── components/
│   │   ├── ProfileCard.vue
│   │   ├── UserHeader.vue
│   │   ├── SettingsForm.vue
│   │   └── SimpleProfileDisplay.vue
│   ├── views/
│   │   ├── Profile.vue
│   │   └── Settings.vue
│   ├── api/
│   │   ├── index.js
│   │   ├── user.js
│   │   └── utils.js
│   ├── composables/
│   │   └── useAuth.js
│   ├── styles/
│   │   └── variables.css
│   └── main.js
└── package.json
```

## 总结

本文档提供了完整的个人主页资料显示代码提取和使用指导。按照以下步骤即可快速集成：

1. ✅ 安装依赖
2. ✅ 配置Element Plus
3. ✅ 引入CSS变量系统
4. ✅ 复制组件和API文件
5. ✅ 创建页面使用组件
6. ✅ 适配你的数据格式
7. ✅ 测试和调试

如有问题，请参考各部分的详细说明或查看源代码注释。

---

**文档完成**: 所有代码提取和使用指导已完成。祝你使用愉快！

